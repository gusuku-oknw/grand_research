# SIS × pHash × Selective Reconstruction Evaluation Template

## 0. Snapshot
- **Date**: YYYY-MM-DD  
- **Experiment Tag**: e.g. `coco-val2017_stageABC`  
- **Code Commit**: `git rev-parse HEAD`
- **Metrics Source**: Path to `metrics.csv` (generated by `experiments/scripts/run_search_experiments.py`)  
- **Figures**: Generated via `python -m experiments.common.plotting metrics.csv --output_dir output/figures/<tag>`

## 1. Dataset & Preprocessing
- **Dataset**: COCO val2017 / CIFAR / custom (specify split sizes).  
- **Derivative Variants**: JPEG (q:95/85/75/60), Gaussian noise (σ:2/5/10), rotate (±4°, ±8°), scale (0.9×/1.1×), crop (5%,10%), color jitter (Δb=0.1, Δc=0.1, Δs=0.1).  
- **Generation Script**: `python experiments/scripts/prepare_coco.py --coco_dir ... --output_dir ... --max_images ... --mapping_json data/coco/derivative_mapping.json`.  
- **Ground Truth Definition**: Each original + all derived variants grouped as a single identity.

## 2. System Configuration
- **Shamir Parameters**: `(k, n)` = (__, __); field `p = 2^64 - 59`.  
- **Stage Pipeline**:  
  - Stage-A: band tokens (`bands = 8`, `token_len = 8`, `epoch_seed = 2025`).  
  - Stage-B: parity lower bound (`stage_b_limit = __`, bytes-per-share = __).  
  - Stage-C: selective reconstruction (`reconstruct_top = __`, `secure_distance = True/False`, `τ` sweep = {6,8,10,12}).  
- **Infrastructure**: single host vs simulated LAN (0.5 ms) / WAN (25 ms). Document simulator or throttling tool if used.

## 3. Search Quality
| Mode | P@1 | P@5 | P@10 | R@10 | mAP |
|------|-----|-----|------|------|-----|
| Plain pHash |  |  |  |  |  |
| SIS + Full Reconstruction |  |  |  |  |  |
| SIS + Selective (Stage-A→C) |  |  |  |  |  |
| SIS + Stage-A→B→C |  |  |  |  |  |
| SIS + Stage-A→B→C + Secure Distance |  |  |  |  |  |

- **Figure (Precision Summary)**: `output/figures/<tag>/precision_summary.png`.
- **Figure (ROC / PR)**: Attach ROC / PR curves from `output/figures/<tag>/roc_<mode>.png`, `pr_<mode>.png` (when generated).  
- **Observation Notes**: Highlight τ ranges that keep Recall@10 within ±2% of plain pHash baseline.

## 4. Efficiency
- **Timing (ms/query)**: Reference stacked bar `time_breakdown.png`. Summarize Stage-A/B/C contributions and phash cost.  
- **Communication (bytes/query)**: Reference `communication_breakdown.png`. Compare to full reconstruction baseline.  
- **Candidate Reduction**: Use `candidate_reduction.png` to report ⟨N_A, N_B, N_C⟩, compute reduction ratios vs total DB.  
- **Latency vs Precision**: Cite `precision_latency.png` for trade-offs.

## 5. Security Checks
- **k-Share Leakage**: Describe experiment verifying entropy / Top-1 re-ID ≈ random (share subset).  
- **Stage-A Token Rotation**: Document token collision rate when epoch seed changes (link to raw counts).  
- **Adversarial Simulation**: Summaries of any tampering / cheating attempts (if executed).

## 6. Robustness
- **Transform Sensitivity**: Report Recall@{1,5,10} per transform category (table).  
- **Distance Histograms**: Include `hist_<variant>.png` figures for JPEG / rotation / noise to illustrate overlap.  
- **τ Sensitivity**: Plot or describe thresholds that maintain >90% Recall@10 on JPEG 75 / rotation ±4°.

## 7. Scaling & Ablations (Optional)
- **DB Size Sweep**: {1k, 10k, 100k}; summarize time / communication scaling.  
- **(k, n) Sweep**: Highlight trade-offs for {3,2}, {5,3}, {7,4}.  
- **Alternative Filters**: Report performance when adding pre-filters (aHash/dHash) or disabling Stage-B.

## 8. Reproducibility Checklist
- Python version, dependency manifest (`pip freeze` or `requirements.txt`).  
- Exact commands run (prepare derivatives, run experiments, plot).  
- Hardware specs (CPU model, RAM, virtualization flags).  
- Random seeds (dataset sampling, Shamir RNG, token HMAC seeds).  
- Output artifacts: `metrics.csv`, `summary.txt`, `figures/`, `reports/`.

## 9. Takeaways
- Does Stage-A→B→C achieve ≥10× reconstruction reduction and ≥3× total latency reduction at 10k+ scale?  
- Any degradation in precision vs plain pHash exceeding tolerable threshold?  
- Security implications or operational caveats surfaced?

> Attach Matplotlib figures inline when exporting to PDF/HTML, or reference relative paths above when maintaining this report in Git.
